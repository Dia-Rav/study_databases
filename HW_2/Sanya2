--part 1, task 2
select
DATEADD(day, 1, EOMONTH(dateId)) as dat, sum(salesRub) as 'Сумма за месяц'
from distributor.singleSales
group by EOMONTH(dateId)
order by EOMONTH(dateId)

--part 1, task 6
select
year(dateId) as year, DATEPART(QUARTER, dateId) as quarter, sum(salesRub) as 'Сумма за квартал'
from distributor.singleSales
group by year(dateId), DATEPART(QUARTER, dateId)
order by year(dateId), DATEPART(QUARTER, dateId)

--part 1, task 10
select
SUBSTRING(fullname, 1, CHARINDEX(' ',fullname)) as 'Фамилия', SUBSTRING(fullname, CHARINDEX(' ',fullname), len(fullname) - CHARINDEX(' ',fullname)) as 'Имя', SUBSTRING(fullname, 1, CHARINDEX(' ',fullname) + 1) + '.' as 'Фамилия И.'
from distributor.singleSales
group by fullname

--part 2, task 4
select branchName as 'Филиал', DATEADD(day, 1, EOMONTH(dateId)) as 'Дата начала месяца', brand as 'Бренд', sum(salesRub) as 'Выручка компании'
from (select dateId, salesRub, b.branchName, c.brand from distributor.sales as a
left join distributor.branch as b
on a.branchId = b.branchId
left join distributor.item as c
on a.itemId = c.itemId) as d
group by branchName, EOMONTH(dateId), brand
order by branchName, EOMONTH(dateId), brand

-- part 2, task 12
select year(dateId) as 'Год', fullname as 'Менеджер', count(distinct companyId) as 'Количество компаний'
from (select dateId, b.fullname, companyId from distributor.sales as a
inner join distributor.salesManager as b
on a.salesManagerId = b.salesManagerId
WHERE b.fullname is not null and companyId is not null) as d
group by year(dateId), fullname
order by year(dateId)
